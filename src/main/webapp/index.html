<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" type="image/png" href="images/favicon.ico" sizes="96x96">

    <!-- Bootstrap 5 Main -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Bootstrap 5 Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">

    <!-- Bootstrap 5 Main -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <!-- Statistics Main -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.0.0/chartjs-plugin-datalabels.min.js" integrity="sha512-R/QOHLpV1Ggq22vfDAWYOaMd5RopHrJNMxi8/lJu8Oihwi4Ho4BRFeiMiCefn9rasajKjnx9/fTQ/xkWnkDACg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- Jquery-->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>

    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css">
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>

    <!-- DataTables Button -->
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.dataTables.min.css">
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>

    <!-- DataTables Select -->
    <link rel="stylesheet" herf="https://cdn.datatables.net/select/1.4.0/css/select.dataTables.min.css">
    <script src="https://cdn.datatables.net/select/1.4.0/js/dataTables.select.min.js"></script>

    <!-- Filter-Script -->
    <script src="js/Filter.js"></script>
    <!-- Search-Script -->
    <script src="js/Search.js"></script>
    <!-- SimplePagination-Script -->
    <script src="js/SimplePagination.js" defer></script>
    <!-- Index-Script -->
    <script src="js/index.js" defer></script>
    <!-- Settings-Script -->
    <script src="js/Settings.js" defer></script>
    <!-- Cookie-Script -->
    <script src="js/Cookie.js" defer></script>
    <!-- Validation-Script -->
    <script src="js/Validation.js" defer></script>
    <!-- Statistics-Script -->
    <script src="js/Statistics.js" defer></script>

    <title>Startseite</title>
    <style>
        :root{
            --main-color: #fff200;
            --main-text-color: #000000;
        }

        .searchbar, .filter-menu, .statistics, .logfile-results{
            margin-right: 1rem;
            margin-left: 1rem;
            margin-top: 2rem;
        }

        .filter-header{
            border-bottom: solid black 1px;
        }

        .chartHeight{
            height: 400px;
        }

        .page-link {
            color: var(--main-color) !important;
        }

        .page-item.active .page-link, .selected td{
            box-shadow: none !important;
            background-color: var(--main-color) !important;
            border: 1px solid var(--main-color) !important;
            color: var(--main-text-color) !important;
        }

        nav{
            background-color: var(--main-color);
            white-space: nowrap;
        }

        .log-textArea{
            /*resize: none;*/
        }

        .log-table{
            border-collapse: separate;
        }

        .dataTables_scrollBody{
            height: 15rem;
            resize: vertical;
            overflow: auto;
        }

        div.dt-buttons{
            float:right!important;
        }

        .button-style{
            background-color: var(--main-color);
            color: var(--main-text-color);
        }

        .button-style:hover{
            color: var(--main-text-color);
        }

        .search-button{
            margin-left: 1rem;
            background-color: var(--main-color);
        }

        .search-bar{
            max-width: 40rem;
        }

        .table-wrapper{
            /*display: block;
            overflow-x: auto;
            white-space: nowrap;*/
        }

        .log-date{
            background-color: var(--main-color);
            color: var(--main-text-color);
        }

        .log-center{
            display: flex;
            align-items: center;
        }

        .badge-color{
            font-family: monospace;
            color: var(--main-text-color);
        }


        table.dataTable td {
            /*potentially change font size if necessary*/
            /*font-size: 15px;*/
        }

        #settingsButton{
            color: var(--main-text-color);
        }

        #logEntryHolder tr:hover{
            background-color: lightgrey;
        }

        #statisticsHolder{
            margin-top: 1rem;
        }

        @media only screen and (max-width: 768px) {
            .introduction > div{
                margin-left: auto;
                margin-right: auto;
            }
            .badge-color{
                width: 4rem;
            }
        }
    </style>
</head>
<body onload="loadDocument()">

<!-- NavBar -->
<nav class="navbar navbar-expand-lg navbar-light sticky-top">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">
            <img src="images/ssi_logo.svg" alt="..." width="200" height="40" style="object-fit: contain">
        </a>
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0 fs-6">
            <li class="nav-item px-3 my-auto">
                <a data-bs-toggle="modal" data-bs-target="#settingsModal">
                    <i class="bi bi-gear-fill fs-3" id="settingsButton"></i>
                </a>
            </li>
        </ul>
    </div>
</nav>
<!-- NavBar -->

<form class="needs-validation" id="searchForm" novalidate>
<div class="searchbar">
    <div class="container">
        <div class="row d-flex">
            <div class="search-container">
                  <div class="d-flex justify-content-center">
                      <input type="text" class="search-bar form-control" placeholder="Suche nach Log-Messages..." name="search" id="search">
                      <button type="button" class="btn button-style search-button" id="searchButton" onclick="openFilterWhenInvalid()">Suchen </button>
                      <input type="hidden" class="onSubmit" onclick="readyForSearch()">
                  </div>
            </div>
        </div>
    </div>
</div>
<!-- Searchbar -->

<!-- Filter-Menu -->
<div class="filter-menu">
    <div class="container">
        <div class="collapse show" id="collapseFilter">
            <div class="d-flex flex-row row" id="FilterContainer">
            <!-- Date-Picker -->
                    <div class="flex-column p-4 col-md-4 text-center border rounded-3">
                        <div class="container">
                            <h5 class="filter-header">Zeitraum beschränken: </h5>
                            <div class=" mt-3">
                                <label for="startDate">Start</label>
                                <input type="text"  class="form-control" id="startDate" oninput="checkInputValidity(this.id)" onchange="checkInputValidity(this.id)" required>
                                <span id="startDateSelected"></span>
                            </div>
                            <input id="startTime" class="form-control" type="input" pattern="^(1\d|2[0-3]|0?\d)(:(([1-5])\d|0?\d)){0,2}$" oninput="addTime(this.id)"  placeholder="00:00:00" disabled/>
                            <div class=" mt-3">
                                <label for="startDate">End</label>
                                <input type="text"  class="form-control" id="endDate" oninput="checkInputValidity(this.id)" onchange="checkInputValidity(this.id)" required>
                                <span id="endDateSelected"></span>
                            </div>
                            <input id="endTime" class="form-control" type="input" pattern="^(1\d|2[0-3]|0?\d)(:(([1-5])\d|0?\d)){0,2}$" oninput="addTime(this.id)" placeholder="00:00:00" disabled />
                        </div>
                    </div>
                <!-- Date-Picker -->

                <!-- Log-Level -->
                <div class="d-flex flex-column p-4 col-md-4 text-center border rounded-3">
                        <div class="container">
                            <h5 class="filter-header" class="mb-3">Log-Level: </h5>
                            <div class="form-check">
                                    <div class="row align-items-center">
                                    <div class="col">
                                        <div>
                                            <div class="mt-3">
                                                <input class="form-check-input logLevelCheckbox" type="checkbox" name="INFO" value="INFO" id="FilterINFO">
                                                <label class="form-check-label" for="FilterINFO">
                                                    INFO
                                                </label>
                                            </div>
                                            <div class="mt-3">
                                                <input class="form-check-input logLevelCheckbox" type="checkbox" name="DEBUG" value="DEBUG" id="FilterDEBUG">
                                                <label class="form-check-label" for="FilterDEBUG">
                                                    DEBUG
                                                </label>
                                            </div>
                                            <div class="mt-3">
                                                <input class="form-check-input logLevelCheckbox" type="checkbox" name="WARN" value="WARN" id="FilterWARN">
                                                <label class="form-check-label" for="FilterWARN">
                                                    WARN
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div>
                                            <div class="mt-3">
                                                <input class="form-check-input logLevelCheckbox" type="checkbox" name="ERROR" value="ERROR" id="FilterERROR">
                                                <label class="form-check-label" for="FilterERROR">
                                                    ERROR
                                                </label>
                                            </div>
                                            <div class="mt-3">
                                                <input class="form-check-input logLevelCheckbox" type="checkbox" name="TRACE" value="TRACE" id="FilterTRACE">
                                                <label class="form-check-label" for="FilterTRACE">
                                                    TRACE
                                                </label>
                                            </div>
                                            <div class="mt-3">
                                                <input class="form-check-input logLevelCheckbox" type="checkbox" name="FATAL" value="FATAL" id="FilterFATAL">
                                                <label class="form-check-label" for="FilterFATAL">
                                                    FATAL
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
            <!-- Log-Level -->

            <!-- Other options -->
                    <div class="d-flex flex-column p-4 col-md-4 text-center border rounded-3">
                            <div class="container">
                                <h5 class="filter-header mb-2">Weitere Optionen </h5>
                                <div>
                                    <label for="modulDataList" class="form-label">Modul:</label>
                                    <input class="form-control" list="datalistOptionsModul" id="modulDataList" oninput="checkIfListInputExists(this.id, this.list.id)" placeholder="Drop down oder Suchen">
                                    <datalist id="datalistOptionsModul">

                                    </datalist>
                                </div>
                                <div>
                                    <label for="classDataList" class="form-label">Klasse:</label>
                                    <input class="form-control" list="datalistOptionsClass" id="classDataList" oninput="checkIfListInputExists(this.id, this.list.id)" placeholder="Drop down oder Suchen">
                                    <datalist id="datalistOptionsClass">

                                    </datalist>
                                </div>
                                <div>
                                    <label for="exceptionDataList" class="form-label">Exception:</label>
                                    <input class="form-control" list="datalistOptionsException" id="exceptionDataList" oninput="checkIfListInputExists(this.id, this.list.id)" placeholder="Drop down oder Suchen">
                                    <datalist id="datalistOptionsException">

                                    </datalist>
                                </div>
                            </div>
                        </div>
                    </div>
             <!-- Other options -->
                </div>
            </div>
            <div class="text-center justify-content-center">
                <button onclick="onCollapseFilter($('#btnFilter'))" id="btnFilter" class="btn button-style" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFilter" aria-expanded="false" aria-controls="collapseFilter">Filter </button>
            </div>
        </div>
    </div>
</form>
<!-- Filter-Menu -->

<!-- Statistics -->
<div class="statistics">
    <div class="container">
        <div class="collapse" id="collapseStatistics">
            <div class="w-100" id="StatisticsContainer">
                <!-- Statistics Dropdown Button -->
                <div class="dropdown text-center">
                    <button class="btn dropdown-toggle button-style" type="button" id="statisticsDropDown" data-bs-toggle="dropdown" aria-expanded="false">
                        Statistken anzeigen
                    </button>
                    <ul class="dropdown-menu p-2" aria-labelledby="statisticsDropDown">
                        <li>
                            <input class="form-check-input statisticsCheckbox" type="checkbox" value="" id="showbarChart" onclick="onShowStatistics(document.getElementById('showbarChart'), 'barChart', 2)">
                            <label class="form-check-label" for="showbarChart">
                                Show Bar-Chart
                            </label>
                        </li>
                        <li>
                            <input class="form-check-input statisticsCheckbox" type="checkbox" value="" id="showpieChart" onclick="onShowStatistics(document.getElementById('showpieChart'), 'pieChart', 1)">
                            <label class="form-check-label" for="showpieChart">
                                Show Pie-Chart
                            </label>
                        </li>
                        <li>
                            <input class="form-check-input statisticsCheckbox" type="checkbox" value="" id="showlineChart" onclick="onShowStatistics(document.getElementById('showlineChart'), 'lineChart', 2)">
                            <label class="form-check-label" for="showlineChart">
                                Show Line-Chart
                            </label>
                        </li>
                        <li>
                            <input class="form-check-input statisticsCheckbox" type="checkbox" value="" id="showpolarAreaChart" onclick="onShowStatistics(document.getElementById('showpolarAreaChart'), 'polarAreaChart', 1)">
                            <label class="form-check-label" for="showpolarAreaChart">
                                Show PolarArea-Chart
                            </label>
                        </li>
                        <li>
                            <input class="form-check-input statisticsCheckbox" type="checkbox" value="" id="showmultiLineChart" onclick="onShowStatistics(document.getElementById('showmultiLineChart'), 'multiLineChart', 2)">
                            <label class="form-check-label" for="showmultiLineChart">
                                Show MultiLine-Chart
                            </label>
                        </li>
                    </ul>
                </div>
                <!-- Statistics Dropdown Button -->

                <!-- Statistics Container -->
                <div class="coll">
                    <div>
                        <div class="d-flex flex-row row" id="statisticsHolder">
                        </div>
                    </div>
                </div>
                <!-- Statistics Container-->

            </div>
        </div>
    </div>
    <div class="text-center justify-content-center">
        <button onclick="onCollapseFilter($('#btnStatistics'))" id="btnStatistics" class="btn button-style" type="button" data-bs-toggle="collapse" data-bs-target="#collapseStatistics" aria-expanded="false" aria-controls="collapseStatistics">Statistiken </button>
    </div>
</div>
<!-- Statistics -->

<!-- Logfile results -->
<div class="logfile-results">
    <div class="container">
        <div class="column" id="logFileElementHolder">

        </div>
        <ul class="pagination justify-content-center visually-hidden mt-2" id="paginator">
            <li class="page-item">
                <a class="page-link" id="btnPrev" onclick="prevPage()">Previous</a>
            </li>
            <li class="page-item active"><a class="page-link"><span id="page"></span></a></li>
            <li class="page-item">
                <a class="page-link" id="btnNext" onclick="nextPage()" >Next</a>
            </li>
        </ul>
    </div>
</div>
<!-- Logfile results -->

<!-- Settings Modal -->
<div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModal" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Einstellungen</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="d-flex flex-column bd-highlight mb-3">
                    <div>
                        <h3>Farben</h3>
                    </div>
                    <div class="border rounded-3 mb-3">
                        <div class="p-2">
                            <label for="path" class="form-label">Element Farbe:</label>
                            <input type="color" id="color" class="w-100" oninput="saveColor($('#color').val())">
                        </div>
                        <div class="p-2">
                            <label for="path" class="form-label">Element Textfarbe:</label>
                            <input type="color" id="textColor" class="w-100" oninput="saveTextColor($('#textColor').val())">
                        </div>
                        <div class="p-2">
                            <button class="btn button-style w-100" type="button" onclick="resetColor()">Zurücksetzten</button>
                        </div>
                    </div>
                    <div>
                        <h3>Log Ordner</h3>
                    </div>
                    <div class="border rounded-3 mb-3">
                        <!--onkeydown is used to disable enter press in modal because it closes the window and reloads the page?-->
                        <form class="needs-validation" novalidate onkeydown="return event.key != 'Enter';">
                            <div class="pt-2 px-2">
                                <label for="path" class="form-label">Logordner Pfad:</label>
                            </div>
                            <div class="input-group px-2">
                                <span class="input-group-text">derzeitiger Pfad</span>
                                <input type="text" class="form-control" id="path" aria-describedby="basic-addon3" pattern='^(~?[\\/]|\w:\\)([^\\/:*?"<>|][\\/]?)*$' required>
                            </div>
                            <div class="p-2">
                                <button class="btn button-style w-100" type="button">Speichern</button>
                                <input class="onSubmit" type="hidden" onclick="setPath($('#path').val())">
                            </div>
                        </form>
                    </div>
                    <div>
                        <h3>Umgebende Logeinträge</h3>
                    </div>
                    <div class="border rounded-3 mb-3">
                        <div class="pt-2 px-2">
                            <label for="path" class="form-label">Limit von gesuchten Bytes umgeben vom ausgewählten Eintrag. z.B. entryID = 5000 Limit = 3000: Range[2000:8000] </label>
                        </div>
                            <div class="px-2">
                                <select class="form-select" id="searchNearby" onchange="reloadSearchNearbyCookie()">
                                    <option hidden>Choose...</option>
                                    <option selected value="0">0</option>
                                    <option value="100">100</option>
                                    <option value="500">500</option>
                                    <option value="1000">1000</option>
                                    <option value="2000">2000</option>
                                    <option value="3000">3000</option>
                                    <option value="5000">5000</option>
                                    <option value="10000">10000</option>
                                </select>
                            </div>
                            <div class="p-2">

                            </div>
                    </div>
                    <div>
                        <h3>Speicherlimit</h3>
                    </div>
                    <div class="border rounded-3 mb-3">
                        <div class="pt-2 px-2">
                            <label for="path" class="form-label">Speicherlimit für Logindex:</label>
                        </div>
                        <div class="input-group px-2">
                            <input type="text" class="form-control" id="limit" aria-describedby="basic-addon3" pattern='^(~?[\\/]|\w:\\)([^\\/:*?"<>|][\\/]?)*$' required>
                            <span class="input-group-text">MB</span>
                        </div>
                        <div class="p-2">
                            <button class="btn button-style w-100" type="button">Speichern</button>
                            <input class="onSubmit" type="hidden">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Settings Modal -->

<!-- Log Modal -->
<div class="modal fade" id="logModal" tabindex="-1" aria-labelledby="logModal" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="logFileTitle">Logfile Name:</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="table-wrapper">
                    <table class="table log-table" id="logEntryTable">
                        <thead>
                        <tr class="sticky-header">
                            <th scope="col">Datum</th>
                            <th scope="col">Log Level</th>
                            <th scope="col">Modul</th>
                            <th scope="col">Klasse</th>
                        </tr>
                        </thead>
                        <tbody id="logEntryHolder">
                        </tbody>
                    </table>
                </div>
                <div class="form-floating mt-3">
                    <textarea disabled class="form-control log-textArea" fetchpriority="high" style="height: 15rem;" placeholder="Click on Log entry to see message" id="floatingTextarea">
                    </textarea>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Log Modal -->

<!-- Indexing-Toast -->
<div class="toastIndex">
    <div class="d-flex">
        <div id="toastIndex" class="position-fixed bottom-0 end-0 p-3" style="z-index: 1056" data-bs-autohide="true" data-bs-delay="2500">
        </div>
    </div>
</div>
<!-- Indexing Toast -->
</body>
</html>
